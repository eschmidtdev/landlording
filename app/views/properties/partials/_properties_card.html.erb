<div class="row mb-4">
  <% @properties.each_with_index do |property| %>
    <div class="col-sm-6 card-margin" id="MyPropertyCardMargin">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between">

            <!-- Property Home Image -->
            <div>
              <%= show_home_image(property.property_type) %>
            </div>

            <!-- DropDown Menu -->
            <div class="dropdown">
              <a type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <%= image_tag 'global_images/more.svg', width: '20' %>
              </a>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="CustomMobileMenu">
                <a class="dropdown-item" href="<%= edit_property_path(1) %>">
                  <div class="d-flex justify-content-start">
                    <%= image_tag 'properties/edit_svg.svg', class: 'm-0', width: '15' %>
                    <span class="ml-2">Edit</span>
                  </div>
                </a>
                <a class="dropdown-item" onclick="deleteProperty(<%= property.id %>)" role="button" data-property-id="<%= property.id %>">
                  <div class="d-flex justify-content-start">
                    <%= image_tag 'properties/delete_icon.svg', class: 'm-0', width: '15' %>
                    <span class="ml-2">Delete</span>
                  </div>
                </a>
              </div>
            </div>
          </div>
          <!-- Property Name -->
          <h3 class="name bold property-nam-mob"><%= show_property_name(property.address_line_one, property.address_line_two) %></h3>

          <hr>
          <!-- Card Footer -->
          <div class="d-flex justify-content-between">

            <!-- Tenant Label -->
            <div>
              <span class="opacity-0-5">Tenant: </span><span class="bold"><%= show_tenant_name(property) %></span>
            </div>

            <!-- Tenant Name -->
            <div>
              <%= image_tag 'properties/property_go_active_arrow.svg', width: '20' %>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>

</div>

<%= javascript_include_tag 'properties' %>

<script>
    function deleteProperty(id) {
        ajaxDeleteReq(id);
    }

    function ajaxDeleteReq(id) {
        $.ajax({
            url: `/properties/${id}`,
            type: 'DELETE',
            data: {
                property: {
                    id: id
                }
            },
            success: function (data) {
                if (data.success === true) {
                    $('html, body').animate({scrollTop: 0}, 'slow');
                    $('.success_alert')
                        .show()
                        .append(data.message)
                        .delay(3000)
                        .fadeOut(300);
                }
                setTimeout(function () {
                    window.location.reload();
                }, 3000);
            },
            error: function (exception) {
            }
        });
    }
</script>

